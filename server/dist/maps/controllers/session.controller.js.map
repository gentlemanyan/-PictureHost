{"version":3,"sources":["../../controllers/session.controller.ts"],"names":[],"mappings":";;AACA,qDAA4C;AAE5C;IACE,gBAAe,CAAC;IAET,KAAK,CAAC,MAAM,CAAC,GAAG,EAAE,IAAI;QAC3B,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;QACzB,MAAM,MAAM,GAAG,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC;QAChC,EAAE,CAAC,CAAE,MAAM,CAAC,QAAQ,KAAK,IAAI,IAAI,MAAM,CAAC,QAAQ,KAAK,EAAG,CAAC,CAAC,CAAC;YACzD,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;QACzB,CAAC;QACD,EAAE,CAAC,CAAE,MAAM,CAAC,QAAQ,KAAK,IAAI,IAAI,MAAM,CAAC,QAAQ,KAAK,EAAG,CAAC,CAAC,CAAC;YACzD,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;QACrB,CAAC;QACD,OAAO,CAAC,GAAG,CAAE,MAAM,CAAC,QAAQ,CAAE,CAAC;QAC/B,OAAO,CAAC,GAAG,CAAE,MAAM,CAAC,QAAQ,CAAE,CAAC;QAE/B,MAAM,IAAI,GAAG,MAAM,iBAAI,CAAC,OAAO,CAAC,EAAC,QAAQ,EAAE,MAAM,CAAC,QAAQ,EAAE,QAAQ,EAAE,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;QACzF,EAAE,CAAC,CAAE,IAAK,CAAC,CAAC,CAAC;YACX,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAC;YAC7C,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAC;YAC7C,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC;YACjB,GAAG,CAAC,IAAI,GAAG;gBACT,IAAI,EAAE,IAAI;gBACV,MAAM,EAAE,eAAe;aACxB,CAAC;QACJ,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC;YACjB,GAAG,CAAC,IAAI,GAAG;gBACT,MAAM,EAAE,mBAAmB;aAC5B,CAAC;QACJ,CAAC;IAEH,CAAC;IAEM,KAAK,CAAC,MAAM,CAAC,GAAG,EAAE,IAAI;IAE7B,CAAC;CACF;AAED,kBAAe,IAAI,iBAAiB,EAAE,CAAC","file":"../../controllers/session.controller.js","sourcesContent":["import { saltHash } from '../lib/auth';\nimport { User } from '../models/user.model';\n\nclass SessionController {\n  constructor() {}\n\n  public async create(ctx, next) {\n    console.log(\"输出会话。。。。。\");\n    const reqObj = ctx.request.body;\n    if ( reqObj.username === null || reqObj.username === '' ) {\n      ctx.throw('用户账户不能为空!');\n    }\n    if ( reqObj.password === null || reqObj.password === '' ) {\n      ctx.throw('请输入密码');\n    }\n    console.log( reqObj.username );\n    console.log( reqObj.password );\n\n    const user = await User.findOne({username: reqObj.username, password: reqObj.password });\n    if ( user ) {\n      ctx.cookies.set('username', reqObj.username);\n      ctx.cookies.set('password', reqObj.password);\n      ctx.status = 200;\n      ctx.body = {\n        data: user,\n        retmsg: 'login success',\n      };\n    } else {\n      ctx.status = 404;\n      ctx.body = {\n        retmsg: '登录失败，请检查账户和密码是否正确',\n      };\n    }\n    // reqObj.password = saltHash(reqObj.password);  password salt and hash\n  }\n\n  public async delete(ctx, next) {\n\n  }\n}\n\nexport default new SessionController();\n"]}